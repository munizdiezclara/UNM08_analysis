---
title: "UNM08 predictiveness in test"
output: pdf_document
date: "2024-01-18"
---

```{r setup, include=FALSE}
library(tidyverse)
library(afex)
library(BayesFactor)
library(apa)
library(emmeans)
library("writexl")
load("UNM08_proc_data.RData")
# function to force scientific formatting of numbers (used for large BFs)
changeSciNot <- function(n) {
  output <- format(n, scientific = TRUE, digits = 2) #Transforms the number into scientific notation even if small
  output <- sub("e", "x10^", output) #Replace e with 10^
  output <- sub("\\+0?", "", output) #Remove + symbol and leading zeros on exponent, if > 1
  output <- sub("-0?", "-", output) #Leaves - symbol but removes leading zeros on exponent, if < 1
  output <- paste0(output,"^")
  # output = strsplit(output, "^", fixed = TRUE)
  # output = paste0(output[[1]][1],"^", output[[1]][2], "^")
  output
}

# function to extract and report BFs with error %s
report_BF_and_error <- function(BF_in, sci_not = TRUE, hyp = "alt"){
  
  if (hyp == "alt") {
    BF_notation = "BF~10~ = "
  } else if (hyp == "null") {
    BF_notation = "BF~01~ = "
  }
  
  if (sci_not == TRUE) {
    BF_value = changeSciNot(extractBF(BF_in)$bf) # change to sci notation
  } else {
    BF_value = round(extractBF(BF_in)$bf,2) # otherwise round
  }
  
  paste0(BF_notation, 
         BF_value, 
         " &plusmn; ", 
         round(100*extractBF(BF_in)$error,2), 
         "%")
}

```
```{r, include=FALSE}
#Create probable response variable, as we are using the uncertain condition
stage1 <- stage1 %>%
  mutate(prob_response = case_when((cue1 == 1 | cue1 == 3) & cue_o_mouse.clicked_name == "o1_image" ~ 1,
                                   (cue1 == 1 | cue1 == 3) & cue_o_mouse.clicked_name == "o2_image" ~ 0, 
                                   (cue1 == 2 | cue1 == 4) & cue_o_mouse.clicked_name == "o1_image" ~ 0,
                                   (cue1 == 2 | cue1 == 4) & cue_o_mouse.clicked_name == "o2_image" ~ 1))
stage2 <- stage2 %>%
  mutate(prob_response = case_when((cue1 == 1 | cue1 == 3) & cue_o_mouse.clicked_name == "o1_image" ~ 1,
                                   (cue1 == 1 | cue1 == 3) & cue_o_mouse.clicked_name == "o2_image" ~ 0, 
                                   (cue1 == 2 | cue1 == 4) & cue_o_mouse.clicked_name == "o1_image" ~ 0,
                                   (cue1 == 2 | cue1 == 4) & cue_o_mouse.clicked_name == "o2_image" ~ 1))
#some exclusion criteria
block6 <- filter(stage1, block == 6) %>%
  group_by(pNum, condition) %>%
  summarise (mean_response = mean(prob_response, na.rm = TRUE))

low_acc <- filter(block6, mean_response < 0.6) 
low_acc <- low_acc$pNum

stage1 <- filter(stage1, !pNum %in% not_passed_pNum & !pNum %in% low_acc)
stage2 <- filter(stage2, !pNum %in% not_passed_pNum & !pNum %in% low_acc)
test <- filter(test, !pNum %in% not_passed_pNum & !pNum %in% low_acc)


N <- unique(stage1$pNum)
```
```{r, include=FALSE}
test <- test %>%
  mutate (congruence = case_when(target == 1 & distractor == 2 ~ "C",
                                 target == 2 & distractor == 1 ~ "C",
                                 target == 5 & distractor == 6 ~ "C",
                                 target == 6 & distractor == 5 ~ "C",
                                 target == 1 & (distractor == 5 | distractor == 6) ~ "NCP",
                                 target == 2 & (distractor == 5 | distractor == 6) ~ "NCP",
                                 target == 5 & (distractor == 1 | distractor == 2) ~ "NCNP",
                                 target == 6 & (distractor == 1 | distractor == 2) ~ "NCNP"))
```

# Congruent trials
```{r}
test1 <- filter(test, congruence == "C")
```

### Accuracy

```{r, include = FALSE}
MA_test <- test1 %>%
  group_by(cue_type, condition) %>%
  summarise(mean_acc = mean(acc, na.rm = TRUE),
            sd_acc = sd(acc, na.rm = TRUE)/sqrt(length(acc)))
```
```{r, echo = FALSE}
ggplot(MA_test) +
  geom_col(mapping = aes(x = cue_type, y = mean_acc, fill = condition)) +
  geom_errorbar(aes(x= cue_type, y = mean_acc, ymin = mean_acc-sd_acc, ymax = mean_acc+sd_acc), color = "black", width=.1,position=position_dodge(0.05)) +
  scale_x_discrete(name = "Type of cue") +
  scale_y_continuous(name="Accuracy") +
  labs(title = "Mean accuracy in the test phase")
```

```{r, include=FALSE}
#ANOVA
acc_test <- test1 %>%
  group_by (pNum, condition, predictiveness) %>%
  summarise(mean_acc = mean(acc, na.rm = TRUE))
acc_test$pNum <- factor(acc_test$pNum)
acc_test$condition <- factor(acc_test$condition)
acc_test$predictiveness <- factor(acc_test$predictiveness)
ANOVA_acc_test <- aov_car(formula = mean_acc ~ condition + Error(pNum/predictiveness), data = acc_test)
print(ANOVA_acc_test)

bay_ANOVA_acc_test <- anovaBF(formula = mean_acc ~ condition + predictiveness + pNum,
        data = data.frame(acc_test),
        whichRandom = "pNum")
print(bay_ANOVA_acc_test)
bay_ANOVA_acc_test_int <- bay_ANOVA_acc_test[4]/bay_ANOVA_acc_test[3]
print(bay_ANOVA_acc_test_int)
```
```{r, include = FALSE}
# Pairwise comparisons between group levels
#condition analysis
#acc_testdition <- emmeans(ANOVA_acc_test, ~ condition)
#pairs(acc_test_condition, adjust = "bon")
```

No significant effects were found (Condition: `r apa(ANOVA_acc_test, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_acc_test[1])`; Predictiveness: `r apa(ANOVA_acc_test, effect = "predictiveness")`, `r report_BF_and_error(bay_ANOVA_acc_test[2])`; ConditionxPredictiveness: `r apa(ANOVA_acc_test, effect = "condition:predictiveness")`, `r report_BF_and_error(bay_ANOVA_acc_test_int[1])`). Bayesian evidence was anecdotal for the null hypothesis for the Condition and moderate null for the Predictiveness and the interaction. .

### Memory score

```{r, include = FALSE}
MM_test <- test1 %>%
  group_by(cue_type, condition) %>%
  summarise(mean_mem = mean(mem_score, na.rm = TRUE),
            sd_mem = sd(mem_score, na.rm = TRUE)/sqrt(length(mem_score)))
```
```{r, echo = FALSE}
ggplot(MM_test) +
  geom_col(mapping = aes(x = cue_type, y = mean_mem, fill = condition)) +
  geom_errorbar(aes(x= cue_type, y = mean_mem, ymin = mean_mem-sd_mem, ymax = mean_mem+sd_mem), color = "black", width=.1,position=position_dodge(0.05)) +
  scale_x_discrete(name = "Type of cue") +
  scale_y_continuous(name="Memory score") +
  labs(title = "Mean memory score in the test phase")
```

```{r, include=FALSE}
#ANOVA
mem_test <- test1 %>%
  group_by (pNum, condition, predictiveness) %>%
  summarise(mean_mem = mean(mem_score, na.rm = TRUE))
mem_test$pNum <- factor(mem_test$pNum)
mem_test$condition <- factor(mem_test$condition)
mem_test$predictiveness <- factor(mem_test$predictiveness)
ANOVA_mem_test <- aov_car(formula = mean_mem ~ condition + Error(pNum/predictiveness), data = mem_test)
print(ANOVA_mem_test)

bay_ANOVA_mem_test <- anovaBF(formula = mean_mem ~ condition + predictiveness + pNum,
        data = data.frame(mem_test),
        whichRandom = "pNum")
print(bay_ANOVA_mem_test)
bay_ANOVA_mem_test_int <- bay_ANOVA_mem_test[4]/bay_ANOVA_mem_test[3]
print(bay_ANOVA_mem_test_int)
```
```{r, include = FALSE}
# Pairwise comparisons between group levels
#interaction analysis
#mem_test_interaction <- emmeans(ANOVA_mem_test, ~ predictiveness|condition)
#pairs(mem_test_interaction, adjust = "bon")
#mem_test_interaction2 <- emmeans(ANOVA_mem_test, ~ condition|predictiveness)
#pairs(mem_test_interaction2, adjust = "bon")
#condition ananlysis
mem_test_condition <- emmeans(ANOVA_mem_test, ~ condition)
pairs(mem_test_condition, adjust = "bon")
```

Responding was higher in the uncertain group than in the certain groups. There were  significant differences in memory due to the Condition, with the bayesian anova indicating anecdotal evidence for the alternative hypothesis (`r apa(ANOVA_mem_test, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_mem_test[1])`). There was non significant evidence of the effect of Predictiveness, showing moderate null bayesian evidence (`r apa(ANOVA_mem_test, effect = "predictiveness")`, `r report_BF_and_error(bay_ANOVA_mem_test[2])`), and of the interaction, showing also moderate null Bayesian evidence (`r apa(ANOVA_acc_test, effect = "condition:predictiveness")`, `r report_BF_and_error(bay_ANOVA_acc_test_int[1])`).

### Corrected memory score (hits x1, errors x0)

```{r, include = FALSE}
Mc_mem_test <- test1 %>%
  group_by(cue_type, condition) %>%
  summarise(mean_c_mem = mean(c_mem_score, na.rm = TRUE),
            sd_c_mem = sd(c_mem_score, na.rm = TRUE)/sqrt(length(c_mem_score)))
```
```{r, echo = FALSE}
ggplot(Mc_mem_test) +
  geom_col(mapping = aes(x = cue_type, y = mean_c_mem, fill = condition)) +
  geom_errorbar(aes(x= cue_type, y = mean_c_mem, ymin = mean_c_mem-sd_c_mem, ymax = mean_c_mem+sd_c_mem), color = "black", width=.1,position=position_dodge(0.05)) +
  scale_x_discrete(name = "Type of cue") +
  scale_y_continuous(name="Corrected memory score") +
  labs(title = "Mean corrected memory score in the test phase")
```

```{r, include=FALSE}
#ANOVA
c_mem_test <- test1 %>%
  group_by (pNum, condition, predictiveness) %>%
  summarise(mean_c_mem = mean(c_mem_score, na.rm = TRUE))
c_mem_test$pNum <- factor(c_mem_test$pNum)
c_mem_test$condition <- factor(c_mem_test$condition)
c_mem_test$predictiveness <- factor(c_mem_test$predictiveness)
ANOVA_c_mem_test <- aov_car(formula = mean_c_mem ~ condition + Error(pNum/predictiveness), data = c_mem_test)
print(ANOVA_c_mem_test)

bay_ANOVA_c_mem_test <- anovaBF(formula = mean_c_mem ~ condition + predictiveness + pNum,
        data = data.frame(c_mem_test),
        whichRandom = "pNum")
print(bay_ANOVA_c_mem_test)
bay_ANOVA_c_mem_test_int <- bay_ANOVA_c_mem_test[4]/bay_ANOVA_c_mem_test[3]
print(bay_ANOVA_c_mem_test_int)
```
```{r, include = FALSE}
# Pairwise comparisons between group levels
#interaction analysis
#c_mem_test_interaction <- emmeans(ANOVA_c_mem_test, ~ predictiveness|condition)
#pairs(c_mem_test_interaction, adjust = "bon")
#c_mem_test_interaction2 <- emmeans(ANOVA_c_mem_test, ~ condition|predictiveness)
#pairs(c_mem_test_interaction2, adjust = "bon")
#condition analysis
c_mem_test_condition<- emmeans(ANOVA_c_mem_test, ~ condition)
pairs(c_mem_test_condition, adjust = "bon")
```

There were no significant differences in memory due to the condition, with the bayesian analysis indicating anecdotal evidence for the alternative hypothesis (`r apa(ANOVA_c_mem_test, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_c_mem_test[1])`; ), nor the  effect of Predictiveness, supported by moderate null bayesian evidence (`r apa(ANOVA_c_mem_test, effect = "predictiveness")`, `r report_BF_and_error(bay_ANOVA_c_mem_test[2])`), neither the effect of interaction, being the bayesian evidence moderate null (`r apa(ANOVA_c_mem_test, effect = "condition:predictiveness")`, `r report_BF_and_error(bay_ANOVA_c_mem_test_int[1])`).

### Corrected memory score (hits x1, errors out)

```{r, include = FALSE}
Mc_mem_test <- filter(test1, acc == 1) %>%
  group_by(cue_type, condition) %>%
  summarise(mean_c_mem = mean(c_mem_score, na.rm = TRUE),
            sd_c_mem = sd(c_mem_score, na.rm = TRUE)/sqrt(length(c_mem_score)))
```
```{r, echo = FALSE}
ggplot(Mc_mem_test) +
  geom_col(mapping = aes(x = cue_type, y = mean_c_mem, fill = condition)) +
  geom_errorbar(aes(x= cue_type, y = mean_c_mem, ymin = mean_c_mem-sd_c_mem, ymax = mean_c_mem+sd_c_mem), color = "black", width=.1,position=position_dodge(0.05)) +
  scale_x_discrete(name = "Type of cue") +
  scale_y_continuous(name="Corrected memory score") +
  labs(title = "Mean corrected memory score in the test phase")
```

```{r, include=FALSE}
#ANOVA
c_mem_test <- filter(test1, acc == 1) %>%
  group_by (pNum, condition, predictiveness) %>%
  summarise(mean_c_mem = mean(c_mem_score, na.rm = TRUE))
c_mem_test$pNum <- factor(c_mem_test$pNum)
c_mem_test$condition <- factor(c_mem_test$condition)
c_mem_test$predictiveness <- factor(c_mem_test$predictiveness)
ANOVA_c_mem_test <- aov_car(formula = mean_c_mem ~ condition + Error(pNum/predictiveness), data = c_mem_test)
print(ANOVA_c_mem_test)

bay_ANOVA_c_mem_test <- anovaBF(formula = mean_c_mem ~ condition + predictiveness + pNum,
        data = data.frame(c_mem_test),
        whichRandom = "pNum")
print(bay_ANOVA_c_mem_test)
bay_ANOVA_c_mem_test_int <- bay_ANOVA_c_mem_test[4]/bay_ANOVA_c_mem_test[3]
print(bay_ANOVA_c_mem_test_int)
```
```{r, include = FALSE}
# Pairwise comparisons between group levels
#interaction analysis
#c_mem_test_interaction <- emmeans(ANOVA_c_mem_test, ~ predictiveness|condition)
#pairs(c_mem_test_interaction, adjust = "bon")
#c_mem_test_interaction2 <- emmeans(ANOVA_c_mem_test, ~ condition|predictiveness)
#pairs(c_mem_test_interaction2, adjust = "bon")
```

There were no significant differences in memory due to the Condition(`r apa(ANOVA_c_mem_test, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_c_mem_test[1])`) nor the interaction (`r apa(ANOVA_c_mem_test, effect = "condition:predictiveness")`, `r report_BF_and_error(bay_ANOVA_c_mem_test_int[1])`). The effect of Predictiveness was significant(`r apa(ANOVA_c_mem_test, effect = "predictiveness")`, `r report_BF_and_error(bay_ANOVA_c_mem_test[2])`) Bayesian evidence was anecdotal null for the Condition, moderate null the interaction and moderate alternative for Predictiveness.

## Test without the certain_short condition

### Accuracy
```{r, include = FALSE}
test_2g <- filter(test1, condition == "Certain" | condition == "Uncertain")
```
```{r, include = FALSE}
MA_test_2g <- test_2g %>%
  group_by(cue_type, condition) %>%
  summarise(mean_acc = mean(acc, na.rm = TRUE),
            sd_acc = sd(acc, na.rm = TRUE)/sqrt(length(acc)))
```
```{r, echo = FALSE}
ggplot(MA_test_2g) +
  geom_col(mapping = aes(x = cue_type, y = mean_acc, fill = condition)) +
  geom_errorbar(aes(x= cue_type, y = mean_acc, ymin = mean_acc-sd_acc, ymax = mean_acc+sd_acc), color = "black", width=.1,position=position_dodge(0.05)) +
  scale_x_discrete(name = "Type of cue") +
  scale_y_continuous(name="Accuracy") +
  labs(title = "Mean accuracy in the test phase")
```

```{r, include=FALSE}
#ANOVA
acc_test_2g <- test_2g %>%
  group_by (pNum, condition, predictiveness) %>%
  summarise(mean_acc = mean(acc, na.rm = TRUE))
acc_test_2g$pNum <- factor(acc_test_2g$pNum)
acc_test_2g$condition <- factor(acc_test_2g$condition)
acc_test_2g$predictiveness <- factor(acc_test_2g$predictiveness)
ANOVA_acc_test_2g <- aov_car(formula = mean_acc ~ condition + Error(pNum/predictiveness), data = acc_test_2g)
print(ANOVA_acc_test_2g)

bay_ANOVA_acc_test_2g <- anovaBF(formula = mean_acc ~ condition + predictiveness + pNum,
        data = data.frame(acc_test_2g),
        whichRandom = "pNum")
print(bay_ANOVA_acc_test_2g)
bay_ANOVA_acc_test_2g_int <- bay_ANOVA_acc_test_2g[4]/bay_ANOVA_acc_test_2g[3]
print(bay_ANOVA_acc_test_2g_int)
```
```{r, include = FALSE}
# Pairwise comparisons between group levels
#condition analysis
#acc_test_2g_condition <- emmeans(ANOVA_acc_test_2g, ~ condition)
#pairs(acc_test_2g_condition, adjust = "bon")
```

Responding was higher in the uncertain group than in the certain group. A mixed model ANOVA found significant the effect of the Condition, but not of the Predictiveness and the interaction (Condition: `r apa(ANOVA_acc_test_2g, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_acc_test_2g[1])`; Predictiveness: `r apa(ANOVA_acc_test_2g, effect = "predictiveness")`, `r report_BF_and_error(bay_ANOVA_acc_test_2g[2])`; ConditionxPredictiveness: `r apa(ANOVA_acc_test_2g, effect = "condition:predictiveness")`, `r report_BF_and_error(bay_ANOVA_acc_test_2g_int[1])`). Bayesian evidence was anecdotal for the alternative hypothesis for Condition, moderate null for the Predictiveness and anecdotal null for the interaction. 

### Memory score

```{r, include = FALSE}
MM_test_2g <- test_2g %>%
  group_by(cue_type, condition) %>%
  summarise(mean_mem = mean(mem_score, na.rm = TRUE),
            sd_mem = sd(mem_score, na.rm = TRUE)/sqrt(length(mem_score)))
```
```{r, echo = FALSE}
ggplot(MM_test_2g) +
  geom_col(mapping = aes(x = cue_type, y = mean_mem, fill = condition)) +
  geom_errorbar(aes(x= cue_type, y = mean_mem, ymin = mean_mem-sd_mem, ymax = mean_mem+sd_mem), color = "black", width=.1,position=position_dodge(0.05)) +
  scale_x_discrete(name = "Type of cue") +
  scale_y_continuous(name="Memory score") +
  labs(title = "Mean memory score in the test phase")
```

```{r, include=FALSE}
#ANOVA
mem_test_2g <- test_2g %>%
  group_by (pNum, condition, predictiveness) %>%
  summarise(mean_mem = mean(mem_score, na.rm = TRUE))
mem_test_2g$pNum <- factor(mem_test_2g$pNum)
mem_test_2g$condition <- factor(mem_test_2g$condition)
mem_test_2g$predictiveness <- factor(mem_test_2g$predictiveness)
ANOVA_mem_test_2g <- aov_car(formula = mean_mem ~ condition + Error(pNum/predictiveness), data = mem_test_2g)
print(ANOVA_mem_test_2g)

bay_ANOVA_mem_test_2g <- anovaBF(formula = mean_mem ~ condition + predictiveness + pNum,
        data = data.frame(mem_test_2g),
        whichRandom = "pNum")
print(bay_ANOVA_mem_test_2g)
bay_ANOVA_mem_test_2g_int <- bay_ANOVA_mem_test_2g[4]/bay_ANOVA_mem_test_2g[3]
print(bay_ANOVA_mem_test_2g_int)
```
```{r, include = FALSE}
# Pairwise comparisons between group levels
#interaction analysis
#mem_test_interaction <- emmeans(ANOVA_mem_test, ~ predictiveness|condition)
#pairs(mem_test_interaction, adjust = "bon")
#mem_test_interaction2 <- emmeans(ANOVA_mem_test, ~ condition|predictiveness)
#pairs(mem_test_interaction2, adjust = "bon")
#condition ananlysis
#mem_test_condition <- emmeans(ANOVA_mem_test, ~ condition)
#pairs(mem_test_condition, adjust = "bon")
```

Responding was higher in the uncertain group than in the certain group. There were significant differences in memory due to the Condition, with the bayesian anova indicating anecdotal evidence for the alternative hypothesis (`r apa(ANOVA_mem_test, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_mem_test[1])`), but not due to Predictiveness, showing moderate null bayesian evidence (`r apa(ANOVA_mem_test, effect = "predictiveness")`, `r report_BF_and_error(bay_ANOVA_mem_test[2])`) nor the interaction, showing anecdotal null Bayesian evidence (`r apa(ANOVA_acc_test, effect = "condition:predictiveness")`, `r report_BF_and_error(bay_ANOVA_acc_test_int[1])`).

### Corrected memory score (hits x1, errors x0)

```{r, include = FALSE}
Mc_mem_test_2g <- test_2g %>%
  group_by(cue_type, condition) %>%
  summarise(mean_c_mem = mean(c_mem_score, na.rm = TRUE),
            sd_c_mem = sd(c_mem_score, na.rm = TRUE)/sqrt(length(c_mem_score)))
```
```{r, echo = FALSE}
ggplot(Mc_mem_test_2g) +
  geom_col(mapping = aes(x = cue_type, y = mean_c_mem, fill = condition)) +
  geom_errorbar(aes(x= cue_type, y = mean_c_mem, ymin = mean_c_mem-sd_c_mem, ymax = mean_c_mem+sd_c_mem), color = "black", width=.1,position=position_dodge(0.05)) +
  scale_x_discrete(name = "Type of cue") +
  scale_y_continuous(name="Corrected memory score") +
  labs(title = "Mean corrected memory score in the test phase")
```

```{r, include=FALSE}
#ANOVA
c_mem_test_2g <- test_2g %>%
  group_by (pNum, condition, predictiveness) %>%
  summarise(mean_c_mem = mean(c_mem_score, na.rm = TRUE))
c_mem_test_2g$pNum <- factor(c_mem_test_2g$pNum)
c_mem_test_2g$condition <- factor(c_mem_test_2g$condition)
c_mem_test_2g$predictiveness <- factor(c_mem_test_2g$predictiveness)
ANOVA_c_mem_test_2g <- aov_car(formula = mean_c_mem ~ condition + Error(pNum/predictiveness), data = c_mem_test_2g)
print(ANOVA_c_mem_test_2g)

bay_ANOVA_c_mem_test_2g <- anovaBF(formula = mean_c_mem ~ condition + predictiveness + pNum,
        data = data.frame(c_mem_test_2g),
        whichRandom = "pNum")
print(bay_ANOVA_c_mem_test_2g)
bay_ANOVA_c_mem_test_2g_int <- bay_ANOVA_c_mem_test_2g[4]/bay_ANOVA_c_mem_test_2g[3]
print(bay_ANOVA_c_mem_test_2g_int)
```
```{r, include = FALSE}
# Pairwise comparisons between group levels
#interaction analysis
#c_mem_test_2g_interaction <- emmeans(ANOVA_c_mem_test_2g, ~ predictiveness|condition)
#pairs(c_mem_test_2g_interaction, adjust = "bon")
#c_mem_test_2g_interaction2 <- emmeans(ANOVA_c_mem_test_2g, ~ condition|predictiveness)
#pairs(c_mem_test_2g_interaction2, adjust = "bon")
#condition analysis
#c_mem_test_condition<- emmeans(ANOVA_c_mem_test, ~ condition)
#pairs(c_mem_test_condition, adjust = "bon")
```

There were no significant differences in memory (Condition: `r apa(ANOVA_c_mem_test, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_c_mem_test[1])`; Predictiveness: `r apa(ANOVA_c_mem_test, effect = "predictiveness")`, `r report_BF_and_error(bay_ANOVA_c_mem_test[2])`; Interaction: `r apa(ANOVA_c_mem_test, effect = "condition:predictiveness")`, `r report_BF_and_error(bay_ANOVA_c_mem_test_int[1])`). bayesian evidence for all effects was anecdotal null.

### Corrected memory score (hits x1, errors out)

```{r, include = FALSE}
Mc_mem_test_2g <- filter(test_2g, acc == 1) %>%
  group_by(cue_type, condition) %>%
  summarise(mean_c_mem = mean(c_mem_score, na.rm = TRUE),
            sd_c_mem = sd(c_mem_score, na.rm = TRUE)/sqrt(length(c_mem_score)))
```
```{r, echo = FALSE}
ggplot(Mc_mem_test_2g) +
  geom_col(mapping = aes(x = cue_type, y = mean_c_mem, fill = condition)) +
  geom_errorbar(aes(x= cue_type, y = mean_c_mem, ymin = mean_c_mem-sd_c_mem, ymax = mean_c_mem+sd_c_mem), color = "black", width=.1,position=position_dodge(0.05)) +
  scale_x_discrete(name = "Type of cue") +
  scale_y_continuous(name="Corrected memory score") +
  labs(title = "Mean corrected memory score in the test phase")
```

```{r, include=FALSE}
#ANOVA
c_mem_test_2g <- filter(test_2g, acc == 1) %>%
  group_by (pNum, condition, predictiveness) %>%
  summarise(mean_c_mem = mean(c_mem_score, na.rm = TRUE))
c_mem_test_2g$pNum <- factor(c_mem_test_2g$pNum)
c_mem_test_2g$condition <- factor(c_mem_test_2g$condition)
c_mem_test_2g$predictiveness <- factor(c_mem_test_2g$predictiveness)
ANOVA_c_mem_test_2g <- aov_car(formula = mean_c_mem ~ condition + Error(pNum/predictiveness), data = c_mem_test_2g)
print(ANOVA_c_mem_test_2g)

bay_ANOVA_c_mem_test_2g <- anovaBF(formula = mean_c_mem ~ condition + predictiveness + pNum,
        data = data.frame(c_mem_test_2g),
        whichRandom = "pNum")
print(bay_ANOVA_c_mem_test_2g)
bay_ANOVA_c_mem_test_2g_int <- bay_ANOVA_c_mem_test_2g[4]/bay_ANOVA_c_mem_test_2g[3]
print(bay_ANOVA_c_mem_test_2g_int)
```
```{r, include = FALSE}
# Pairwise comparisons between group levels
#interaction analysis
#c_mem_test_2g_interaction <- emmeans(ANOVA_c_mem_test_2g, ~ predictiveness|condition)
#pairs(c_mem_test_2g_interaction, adjust = "bon")
#c_mem_test_2g_interaction2 <- emmeans(ANOVA_c_mem_test_2g, ~ condition|predictiveness)
#pairs(c_mem_test_2g_interaction2, adjust = "bon")
```

There were no significant differences in memory (Condition: `r apa(ANOVA_c_mem_test, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_c_mem_test[1])`;Predictiveness: `r apa(ANOVA_c_mem_test, effect = "predictiveness")`, `r report_BF_and_error(bay_ANOVA_c_mem_test[2])`; Interaction: `r apa(ANOVA_c_mem_test, effect = "condition:predictiveness")`, `r report_BF_and_error(bay_ANOVA_c_mem_test_int[1])`). Bayesian evidence was anecdotal null for all effects. 

## Certain only trials
### Accuracy
```{r, include = FALSE}
test_certain <- filter(test1, condition == "Certain")
```
```{r, include = FALSE}
MA_test_certain <- test_certain %>%
  group_by(cue_type, condition) %>%
  summarise(mean_acc = mean(acc, na.rm = TRUE),
            sd_acc = sd(acc, na.rm = TRUE)/sqrt(length(acc)))
```
```{r, echo = FALSE}
ggplot(MA_test_certain) +
  geom_col(mapping = aes(x = cue_type, y = mean_acc, fill = condition)) +
  geom_errorbar(aes(x= cue_type, y = mean_acc, ymin = mean_acc-sd_acc, ymax = mean_acc+sd_acc), color = "black", width=.1,position=position_dodge(0.05)) +
  scale_x_discrete(name = "Type of cue") +
  scale_y_continuous(name="Accuracy") +
  labs(title = "Mean accuracy in the test phase")
```

```{r, include=FALSE}
#ANOVA
acc_test_certain <- test_certain %>%
  group_by (pNum, predictiveness) %>%
  summarise(acc = mean(acc, na.rm = TRUE))
# compute the difference
d <- with(acc_test_certain, 
        acc[predictiveness == "non-predictive"] - acc[predictiveness == "predictive"])
# Shapiro-Wilk normality test for the differences
shapiro.test(d)
```
```{r, include=FALSE}
wilcox_acc_test_certain <- wilcox.test(acc ~ predictiveness, data = acc_test_certain, paired = TRUE)
print(wilcox_acc_test_certain)

pred_acc_test_certain <- subset(acc_test_certain,  predictiveness == "predictive", acc, drop = TRUE)
nonpred_acc_test_certain <- subset(acc_test_certain,  predictiveness == "non-predictive", acc, drop = TRUE)
bay_t.test_acc_test_certain <-  ttestBF(pred_acc_test_certain, nonpred_acc_test_certain, paired = TRUE)
print(bay_t.test_acc_test_certain)
```
There are no differences in accuracy due to predictiveness, and the bayesian analysis indicates moderate evidence for the null hypothesis (*V* = `r  wilcox_acc_test_certain[["statistic"]]`, *p* = `r wilcox_acc_test_certain[["p.value"]]`, `r report_BF_and_error(bay_t.test_acc_test_certain[1])`).

### Memory score

```{r, include = FALSE}
MM_test_certain <- test_certain %>%
  group_by(cue_type, condition) %>%
  summarise(mean_mem = mean(mem_score, na.rm = TRUE),
            sd_mem = sd(mem_score, na.rm = TRUE)/sqrt(length(mem_score)))
```
```{r, echo = FALSE}
ggplot(MM_test_certain) +
  geom_col(mapping = aes(x = cue_type, y = mean_mem, fill = condition)) +
  geom_errorbar(aes(x= cue_type, y = mean_mem, ymin = mean_mem-sd_mem, ymax = mean_mem+sd_mem), color = "black", width=.1,position=position_dodge(0.05)) +
  scale_x_discrete(name = "Type of cue") +
  scale_y_continuous(name="Memory score") +
  labs(title = "Mean memory score in the test phase")
```

```{r, include=FALSE}
mem_test_certain <- test_certain %>%
  group_by (pNum, predictiveness) %>%
  summarise(mem = mean(mem_score, na.rm = TRUE))
# compute the difference
d <- with(mem_test_certain, 
        mem[predictiveness == "non-predictive"] - mem[predictiveness == "predictive"])
# Shapiro-Wilk normality test for the differences
shapiro.test(d)
```
```{r, include=FALSE}
t.test_mem_test_certain <- t.test(mem ~ predictiveness, data = mem_test_certain, paired = TRUE)
print(t.test_mem_test_certain)

pred_mem_test_certain <- subset(mem_test_certain,  predictiveness == "predictive", mem, drop = TRUE)
nonpred_mem_test_certain <- subset(mem_test_certain,  predictiveness == "non-predictive", mem, drop = TRUE)
bay_t.test_mem_test_certain <-  ttestBF(pred_mem_test_certain, nonpred_mem_test_certain, paired = TRUE)
print(bay_t.test_mem_test_certain)
```

There are no differences in memory due to predictiveness, and the bayesian analysis indicates anecdotal evidence for the null hypothesis (`r apa(t.test_mem_test_certain)`, `r report_BF_and_error(bay_t.test_mem_test_certain[1])`).

### Corrected memory score (hits x1, errors x0)

```{r, include = FALSE}
Mc_mem_test_certain <- test_certain %>%
  group_by(cue_type, condition) %>%
  summarise(mean_c_mem = mean(c_mem_score, na.rm = TRUE),
            sd_c_mem = sd(c_mem_score, na.rm = TRUE)/sqrt(length(c_mem_score)))
```
```{r, echo = FALSE}
ggplot(Mc_mem_test_certain) +
  geom_col(mapping = aes(x = cue_type, y = mean_c_mem, fill = condition)) +
  geom_errorbar(aes(x= cue_type, y = mean_c_mem, ymin = mean_c_mem-sd_c_mem, ymax = mean_c_mem+sd_c_mem), color = "black", width=.1,position=position_dodge(0.05)) +
  scale_x_discrete(name = "Type of cue") +
  scale_y_continuous(name="Corrected memory score") +
  labs(title = "Mean corrected memory score in the test phase")
```

```{r, include=FALSE}
c_mem_test_certain <- test_certain %>%
  group_by (pNum, predictiveness) %>%
  summarise(c_mem = mean(c_mem_score, na.rm = TRUE))
# compute the difference
d <- with(c_mem_test_certain, 
        c_mem[predictiveness == "non-predictive"] - c_mem[predictiveness == "predictive"])
# Shapiro-Wilk normality test for the differences
shapiro.test(d)
```
```{r, include=FALSE}
t.test_c_mem_test_certain <- t.test(c_mem ~ predictiveness, data = c_mem_test_certain, paired = TRUE)
print(t.test_c_mem_test_certain)

pred_c_mem_test_certain <- subset(c_mem_test_certain,  predictiveness == "predictive", c_mem, drop = TRUE)
nonpred_c_mem_test_certain <- subset(c_mem_test_certain,  predictiveness == "non-predictive", c_mem, drop = TRUE)
bay_t.test_c_mem_test_certain <-  ttestBF(pred_c_mem_test_certain, nonpred_c_mem_test_certain, paired = TRUE)
print(bay_t.test_c_mem_test_certain)
```

There are no differences in memory due to predictiveness, and the bayesian analysis indicates anecdotal evidence for the null hypothesis (`r apa(t.test_c_mem_test_certain)`, `r report_BF_and_error(bay_t.test_c_mem_test_certain[1])`).

### Corrected memory score (hits x1, errors out)

```{r, include = FALSE}
Mc_mem_test_certain <- filter(test_certain, acc == 1) %>%
  group_by(cue_type, condition) %>%
  summarise(mean_c_mem = mean(c_mem_score, na.rm = TRUE),
            sd_c_mem = sd(c_mem_score, na.rm = TRUE)/sqrt(length(c_mem_score)))
```
```{r, echo = FALSE}
ggplot(Mc_mem_test_certain) +
  geom_col(mapping = aes(x = cue_type, y = mean_c_mem, fill = condition)) +
  geom_errorbar(aes(x= cue_type, y = mean_c_mem, ymin = mean_c_mem-sd_c_mem, ymax = mean_c_mem+sd_c_mem), color = "black", width=.1,position=position_dodge(0.05)) +
  scale_x_discrete(name = "Type of cue") +
  scale_y_continuous(name="Corrected memory score") +
  labs(title = "Mean corrected memory score in the test phase")
```

```{r, include=FALSE}
c_mem_test_certain <- filter(test_certain, acc == 1 & pNum != 37) %>%
  group_by (pNum, predictiveness) %>%
  summarise(c_mem = mean(c_mem_score, na.rm = TRUE))
# compute the difference
d <- with(c_mem_test_certain, 
        c_mem[predictiveness == "non-predictive"] - c_mem[predictiveness == "predictive"])
# Shapiro-Wilk normality test for the differences
shapiro.test(d)
```
```{r, include=FALSE}
wilcox_c_mem_test_certain <- wilcox.test(c_mem ~ predictiveness, data = c_mem_test_certain, paired = TRUE)
print(wilcox_c_mem_test_certain)

pred_c_mem_test_certain <- subset(c_mem_test_certain,  predictiveness == "predictive", c_mem, drop = TRUE)
nonpred_c_mem_test_certain <- subset(c_mem_test_certain,  predictiveness == "non-predictive", c_mem, drop = TRUE)
bay_t.test_c_mem_test_certain <-  ttestBF(pred_c_mem_test_certain, nonpred_c_mem_test_certain, paired = TRUE)
print(bay_t.test_c_mem_test_certain)
```

There are no differences in memory due to predictiveness, and the bayesian analysis indicates anecdotal evidence for the null hypothesis (`r apa(t.test_c_mem_test_certain)`, `r report_BF_and_error(bay_t.test_c_mem_test_certain[1])`). 
